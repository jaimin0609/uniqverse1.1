# Test info

- Name: Shopping and Checkout Flow >> should calculate totals correctly
- Location: C:\Users\James\Desktop\uniqverse-v1\e2e\shopping-flow.spec.ts:518:9

# Error details

```
Error: page.goto: Test timeout of 30000ms exceeded.
Call log:
  - navigating to "http://localhost:3000/shop", waiting until "load"

    at C:\Users\James\Desktop\uniqverse-v1\e2e\shopping-flow.spec.ts:520:20
```

# Page snapshot

```yaml
- banner:
  - link "UniQVerse":
    - /url: /
  - navigation:
    - link "Home":
      - /url: /
    - link "Shop":
      - /url: /shop
    - button "Categories"
    - link "All Categories":
      - /url: /categories
    - link "Shop Featured":
      - /url: /shop/featured
    - link "New Arrivals":
      - /url: /shop/new
    - link "About":
      - /url: /about
    - link "Careers":
      - /url: /careers
    - link "Support":
      - /url: /support
    - link "Contact":
      - /url: /contact
  - button "Search"
  - text: Search /
  - button "Settings"
  - button "Open shopping cart"
  - link "Sign In":
    - /url: /auth/login
    - button "Sign In"
  - button "Open menu"
- main:
  - heading "Shop Our Products" [level=1]
  - button "Show Filters"
  - heading "Filters" [level=2]
  - button "Categories":
    - heading "Categories" [level=3]
  - button "Price":
    - heading "Price" [level=3]
  - button "Newest"
  - text: Showing 11 products 74% OFF
  - link "Retro Creative Snake Chain Anklet Four-piece Set Add to wishlist Add to cart Retro Creative Snake Chain Anklet Four-piece Set Body Jewelry ... ...":
    - /url: /products/retro-creative-snake-chain-anklet-four-piece-set
    - img "Retro Creative Snake Chain Anklet Four-piece Set"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Retro Creative Snake Chain Anklet Four-piece Set" [level=3]
    - paragraph: Body Jewelry
    - paragraph: ...
    - paragraph: ...
  - text: 50% OFF
  - link "Bow Love Five Break Flower Pearl Resin Drill Nail Accessories Add to wishlist Add to cart Bow Love Five Break Flower Pearl Resin Drill Nail Accessories Body Jewelry ... ...":
    - /url: /products/bow-love-five-break-flower-pearl-resin-drill-nail-accessories
    - img "Bow Love Five Break Flower Pearl Resin Drill Nail Accessories"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Bow Love Five Break Flower Pearl Resin Drill Nail Accessories" [level=3]
    - paragraph: Body Jewelry
    - paragraph: ...
    - paragraph: ...
  - text: 25% OFF
  - link "Testing Add to wishlist Add to cart Testing Clothing ... ...":
    - /url: /products/testing-1
    - img "Testing"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Testing" [level=3]
    - paragraph: Clothing
    - paragraph: ...
    - paragraph: ...
  - text: 50% OFF
  - link "Printed Double-layer Composite Blanket Household Add to wishlist Add to cart Printed Double-layer Composite Blanket Household Bedding Sets ... ...":
    - /url: /products/printed-double-layer-composite-blanket-household
    - img "Printed Double-layer Composite Blanket Household"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Printed Double-layer Composite Blanket Household" [level=3]
    - paragraph: Bedding Sets
    - paragraph: ...
    - paragraph: ...
  - text: 25% OFF
  - link "High-end Entry Lux Mink Fur Blanket Double-sided Add to wishlist Add to cart High-end Entry Lux Mink Fur Blanket Double-sided Bedding Sets ... ...":
    - /url: /products/high-end-entry-lux-mink-fur-blanket-double-sided
    - img "High-end Entry Lux Mink Fur Blanket Double-sided"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "High-end Entry Lux Mink Fur Blanket Double-sided" [level=3]
    - paragraph: Bedding Sets
    - paragraph: ...
    - paragraph: ...
  - text: 29% OFF
  - link "High-end Solid Color Bed Sheet Bamboo Fiber Summer Mat Add to wishlist Add to cart High-end Solid Color Bed Sheet Bamboo Fiber Summer Mat Bedding Sets ... ...":
    - /url: /products/high-end-solid-color-bed-sheet-bamboo-fiber-summer-mat
    - img "High-end Solid Color Bed Sheet Bamboo Fiber Summer Mat"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "High-end Solid Color Bed Sheet Bamboo Fiber Summer Mat" [level=3]
    - paragraph: Bedding Sets
    - paragraph: ...
    - paragraph: ...
  - text: 33% OFF
  - link "Ladies Style White Dress Satin Surface Was Thin And High French Temperament Dress Long Skirt Add to wishlist Add to cart Ladies Style White Dress Satin Surface Was Thin And High French Temperament Dress Long Skirt Wedding & Events ... ...":
    - /url: /products/ladies-style-white-dress-satin-surface-was-thin-and-high-french-temperament-dress-long-skirt
    - img "Ladies Style White Dress Satin Surface Was Thin And High French Temperament Dress Long Skirt"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Ladies Style White Dress Satin Surface Was Thin And High French Temperament Dress Long Skirt" [level=3]
    - paragraph: Wedding & Events
    - paragraph: ...
    - paragraph: ...
  - text: 25% OFF
  - link "Top Short Skirt Three-dimensional Flower Pettiskirt French Cross-border Dress Add to wishlist Add to cart Top Short Skirt Three-dimensional Flower Pettiskirt French Cross-border Dress For Her ... ...":
    - /url: /products/top-short-skirt-three-dimensional-flower-pettiskirt-french-cross-border-dress
    - img "Top Short Skirt Three-dimensional Flower Pettiskirt French Cross-border Dress"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Top Short Skirt Three-dimensional Flower Pettiskirt French Cross-border Dress" [level=3]
    - paragraph: For Her
    - paragraph: ...
    - paragraph: ...
  - text: 29% OFF
  - link "Green Sequined Sexy High Waist Fishtail Long Evening Dress Add to wishlist Add to cart Green Sequined Sexy High Waist Fishtail Long Evening Dress Wedding & Events ... ...":
    - /url: /products/green-sequined-sexy-high-waist-fishtail-long-evening-dress
    - img "Green Sequined Sexy High Waist Fishtail Long Evening Dress"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "Green Sequined Sexy High Waist Fishtail Long Evening Dress" [level=3]
    - paragraph: Wedding & Events
    - paragraph: ...
    - paragraph: ...
  - text: 25% OFF
  - link "American Street Solid Color Fleece Hooded Sweatshirt For Men And Women Add to wishlist Add to cart American Street Solid Color Fleece Hooded Sweatshirt For Men And Women For Her ... ...":
    - /url: /products/american-street-solid-color-fleece-hooded-sweatshirt-for-men-and-women
    - img "American Street Solid Color Fleece Hooded Sweatshirt For Men And Women"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "American Street Solid Color Fleece Hooded Sweatshirt For Men And Women" [level=3]
    - paragraph: For Her
    - paragraph: ...
    - paragraph: ...
  - text: 33% OFF
  - link "White French Gentle Seaside Holiday Oblique Shoulder Strap Dress Add to wishlist Add to cart White French Gentle Seaside Holiday Oblique Shoulder Strap Dress Dress ... ...":
    - /url: /products/white-french-gentle-seaside-holiday-oblique-shoulder-strap-dress-in21ab
    - img "White French Gentle Seaside Holiday Oblique Shoulder Strap Dress"
    - button "Add to wishlist"
    - button "Add to cart"
    - heading "White French Gentle Seaside Holiday Oblique Shoulder Strap Dress" [level=3]
    - paragraph: Dress
    - paragraph: ...
    - paragraph: ...
- contentinfo:
  - paragraph: Â© 2025 UniQVerse. All rights reserved.
- region "Notifications alt+T"
```

# Test source

```ts
  420 |         await expect(page.locator('label:has-text("Card Details")')).toBeVisible();
  421 |         await expect(page.locator('button:has-text("Pay")')).toBeVisible();
  422 |     });
  423 |
  424 |     test('should handle checkout validation errors', async ({ page }) => {
  425 |         // Navigate to checkout without items (should show error or redirect)
  426 |         await page.goto('/checkout');
  427 |
  428 |         // Try to place order without filling required fields
  429 |         const placeOrderButton = page.locator('button:has-text("Place Order")'); if (await placeOrderButton.isVisible()) {
  430 |             await placeOrderButton.click();
  431 |             // Should show validation errors
  432 |             await expect(page.locator('text="required", text="Please fill"')).toBeVisible({ timeout: 5000 });
  433 |         }
  434 |     });
  435 |
  436 |     test('should persist cart across sessions', async ({ page, context }) => {
  437 |         // Add item to cart
  438 |         await page.goto('/shop');
  439 |
  440 |         const productCard = page.locator('.group.relative.bg-white.rounded-lg a[href*="/products/"]').first();
  441 |         await expect(productCard).toBeVisible({ timeout: 10000 });
  442 |
  443 |         // Navigate directly to product page
  444 |         const productUrl = await productCard.getAttribute('href');
  445 |         if (productUrl) {
  446 |             await page.goto(productUrl);
  447 |             await page.waitForLoadState('networkidle');
  448 |         } else {
  449 |             await productCard.click();
  450 |         }
  451 |
  452 |         const addToCartButton = page.locator('main button:has-text("Add to Cart"), .product-details button:has-text("Add to Cart")').first();
  453 |         await expect(addToCartButton).toBeVisible({ timeout: 10000 });
  454 |         await addToCartButton.click();
  455 |         await page.waitForTimeout(500);
  456 |
  457 |         // Dismiss toast notifications
  458 |         await dismissToasts(page);
  459 |
  460 |         // Sync cart to server by opening cart to trigger sync
  461 |         const cartButton = page.locator('header button[aria-label="Open shopping cart"]');
  462 |         await cartButton.click({ force: true, timeout: 10000 });
  463 |         await expect(page.locator('[data-testid="cart-drawer"]')).toBeVisible();
  464 |
  465 |         // Verify item is in cart and wait for sync
  466 |         await expect(page.locator('[data-testid="cart-drawer"] ul li').first()).toBeVisible();
  467 |         await page.waitForTimeout(500); // Allow time for server sync
  468 |
  469 |         // Close cart
  470 |         const closeButton = page.locator('[aria-label="Close cart"]');
  471 |         await closeButton.click({ force: true });
  472 |         await page.waitForTimeout(300);
  473 |
  474 |         // Create a new browser context (simulates new session/browser)
  475 |         const newContext = await page.context().browser()!.newContext();
  476 |         const newPage = await newContext.newPage();
  477 |
  478 |         // Login in new context with same user
  479 |         await newPage.goto('/auth/login');
  480 |         await newPage.fill('input[name="email"]', 'jaimin0609@gmail.com');
  481 |         await newPage.fill('input[name="password"]', '6941@Sjp');
  482 |         await newPage.click('[data-testid="login-submit-button"]');
  483 |
  484 |         // Wait for login to complete
  485 |         try {
  486 |             await newPage.waitForURL('/', { timeout: 10000 });
  487 |         } catch {
  488 |             const userDropdown = newPage.locator('button:has(svg.lucide-user), .group:has(svg.lucide-user)').first();
  489 |             await expect(userDropdown).toBeVisible({ timeout: 5000 });
  490 |         }
  491 |
  492 |         // Wait for cart sync to complete (reduced timeout)
  493 |         await newPage.waitForTimeout(2000);
  494 |
  495 |         // Check if cart still has items
  496 |         const newCartButton = newPage.locator('header button[aria-label="Open shopping cart"]');
  497 |         await newCartButton.click();
  498 |
  499 |         // Wait for cart to open and sync
  500 |         await expect(newPage.locator('[data-testid="cart-drawer"]')).toBeVisible();
  501 |         await newPage.waitForTimeout(1000);
  502 |
  503 |         // Cart should either contain the item or show as empty (depending on sync timing)
  504 |         // We'll check for either state as both are valid depending on server sync
  505 |         try {
  506 |             await expect(newPage.locator('[data-testid="cart-drawer"] ul li').first()).toBeVisible({ timeout: 5000 });
  507 |             console.log('Cart persistence successful - items found');
  508 |         } catch {
  509 |             // If no items found, that's also acceptable as the test environment may clear carts
  510 |             const emptyMessage = newPage.locator('[data-testid="cart-drawer"] h3:has-text("Your cart is empty")'); await expect(emptyMessage).toBeVisible({ timeout: 5000 });
  511 |             console.log('Cart appears empty - this may be expected in test environment');
  512 |         }
  513 |
  514 |         // Clean up
  515 |         await newContext.close();
  516 |     });
  517 |
  518 |     test('should calculate totals correctly', async ({ page }) => {
  519 |         // Add multiple items to cart
> 520 |         await page.goto('/shop');
      |                    ^ Error: page.goto: Test timeout of 30000ms exceeded.
  521 |
  522 |         // Add first product
  523 |         const firstProduct = page.locator('.group.relative.bg-white.rounded-lg a[href*="/products/"]').first();
  524 |         await expect(firstProduct).toBeVisible({ timeout: 10000 });
  525 |
  526 |         // Navigate directly to first product
  527 |         const firstProductUrl = await firstProduct.getAttribute('href');
  528 |         if (firstProductUrl) {
  529 |             await page.goto(firstProductUrl);
  530 |             await page.waitForLoadState('networkidle');
  531 |         } else {
  532 |             await firstProduct.click();
  533 |         }
  534 |
  535 |         await page.locator('main button:has-text("Add to Cart"), .product-details button:has-text("Add to Cart")').first().click();
  536 |         await page.waitForTimeout(500);
  537 |
  538 |         // Go back and add another product
  539 |         await page.goto('/shop');
  540 |         const secondProduct = page.locator('.group.relative.bg-white.rounded-lg a[href*="/products/"]').nth(1);
  541 |         await secondProduct.click();
  542 |
  543 |         await page.locator('main button:has-text("Add to Cart"), .product-details button:has-text("Add to Cart")').first().click();
  544 |         await page.waitForTimeout(500);
  545 |
  546 |         // Dismiss toast notifications
  547 |         await dismissToasts(page);
  548 |
  549 |         // Open cart and check totals - using header cart button
  550 |         const cartButton = page.locator('header button[aria-label="Open shopping cart"]');
  551 |         await cartButton.click();
  552 |
  553 |         // Verify subtotal is displayed (from cart-drawer.tsx)
  554 |         await expect(page.locator('text="Subtotal"')).toBeVisible();
  555 |     });
  556 | });
  557 |
```